# üé∞ Telegram Mini App - AI –†—É–ª–µ—Ç–∫–∞ –ü—Ä–∏–∑–æ–≤

## –û–±–∑–æ—Ä

Telegram Mini App —Å –∫—Ä–∞—Å–∏–≤–æ–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π —Ä—É–ª–µ—Ç–∫–æ–π –¥–ª—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞ —Å–∫–∏–¥–æ–∫ –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –æ—Ç 5,000 –¥–æ 30,000 —Ä—É–±–ª–µ–π. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∫—Ä—É—Ç–∏—Ç—å —Ä—É–ª–µ—Ç–∫—É –æ–¥–∏–Ω —Ä–∞–∑ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –≤ –º–µ–Ω—é –±–æ—Ç–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø—Ä–æ—Å–∞.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram Bot   ‚îÇ
‚îÇ   (Python)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ WebAppInfo URL
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Mini App      ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ  aiohttp     ‚îÇ
‚îÇ  (HTML/CSS/JS)  ‚îÇ      ‚îÇ  Web Server  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                                ‚ñº
                         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                         ‚îÇ  PostgreSQL  ‚îÇ
                         ‚îÇ   Database   ‚îÇ
                         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
mini_app/
‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îú‚îÄ‚îÄ index.html      # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ä—É–ª–µ—Ç–∫–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ style.css       # –°—Ç–∏–ª–∏ –∏ –∞–Ω–∏–º–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ script.js       # –õ–æ–≥–∏–∫–∞ —Ä—É–ª–µ—Ç–∫–∏ –∏ Canvas API
‚îú‚îÄ‚îÄ server.py           # aiohttp –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
‚îî‚îÄ‚îÄ [shared files]
    ‚îú‚îÄ‚îÄ app/database.py # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (shared)
    ‚îî‚îÄ‚îÄ app/config.py   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (shared)
```

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `roulette_spins`

```sql
CREATE TABLE roulette_spins (
    id SERIAL PRIMARY KEY,
    telegram_id BIGINT NOT NULL UNIQUE,
    prize_amount INTEGER NOT NULL,
    spun_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

**–ü–æ–ª—è:**
- `telegram_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
- `prize_amount` - –°—É–º–º–∞ –ø—Ä–∏–∑–∞ (5000, 10000, 15000, 20000, 30000)
- `spun_at` - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≤—Ä–∞—â–µ–Ω–∏—è
- `UNIQUE` constraint –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ–¥–∏–Ω —Å–ø–∏–Ω –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ú–µ—Ç–æ–¥—ã API –≤ `database.py`

```python
async def can_spin_roulette(telegram_id: int) -> bool
    """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫—Ä—É—Ç–∏—Ç—å —Ä—É–ª–µ—Ç–∫—É"""

async def save_roulette_spin(telegram_id: int, prize_amount: int)
    """–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—Ä–∞—â–µ–Ω–∏—è"""

async def get_user_prize(telegram_id: int) -> int
    """–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
```

## API Endpoints

### GET `/api/health`
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞

**Response:**
```json
{"status": "ok"}
```

### GET `/api/can-spin?telegram_id={id}`
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫—Ä—É—Ç–∏—Ç—å —Ä—É–ª–µ—Ç–∫—É

**Response:**
```json
{
  "can_spin": true,
  "prize": null
}
```
–∏–ª–∏
```json
{
  "can_spin": false,
  "prize": 15000
}
```

### POST `/api/spin`
–ö—Ä—É—Ç–∏—Ç—å —Ä—É–ª–µ—Ç–∫—É –∏ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–∑

**Request:**
```json
{
  "telegram_id": 123456789
}
```

**Response (—É—Å–ø–µ—Ö):**
```json
{
  "prize": 20000
}
```

**Response (—É–∂–µ –∫—Ä—É—Ç–∏–ª):**
```json
{
  "error": "Already spun",
  "prize": 20000
}
```

## Frontend (Mini App)

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **Vanilla JavaScript** - –ë–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- **Canvas API** - –î–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –∏ –∞–Ω–∏–º–∞—Ü–∏–∏ —Ä—É–ª–µ—Ç–∫–∏
- **Telegram WebApp API** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram
- **CSS Animations** - –ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### `drawWheel(rotation)`
–†–∏—Å—É–µ—Ç —Ä—É–ª–µ—Ç–∫—É —Å 5 —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ —Ä–∞–∑–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤ –∏ —Å—É–º–º–∞–º–∏ –ø—Ä–∏–∑–æ–≤

#### `animateSpin(targetPrize)`
–ê–Ω–∏–º–∏—Ä—É–µ—Ç –≤—Ä–∞—â–µ–Ω–∏–µ —Ä—É–ª–µ—Ç–∫–∏ —Å easing —ç—Ñ—Ñ–µ–∫—Ç–æ–º (ease-out cubic)
- 5 –ø–æ–ª–Ω—ã—Ö –æ–±–æ—Ä–æ—Ç–æ–≤
- 4 —Å–µ–∫—É–Ω–¥—ã –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –≤—ã–∏–≥—Ä–∞–Ω–Ω–æ–º –ø—Ä–∏–∑–µ

#### `checkCanSpin()`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫—Ä—É—Ç–∏—Ç—å —Ä—É–ª–µ—Ç–∫—É
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç loading screen
- –ü–æ–ª—É—á–∞–µ—Ç telegram user ID —á–µ—Ä–µ–∑ `tg.initDataUnsafe`
- –ï—Å–ª–∏ —É–∂–µ –∫—Ä—É—Ç–∏–ª - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –ø—Ä–∏–∑

#### `spin()`
–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
- –í—ã–∑—ã–≤–∞–µ—Ç API `/api/spin`
- –ó–∞–ø—É—Å–∫–∞–µ—Ç –∞–Ω–∏–º–∞—Ü–∏—é
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- Haptic feedback (–≤–∏–±—Ä–∞—Ü–∏—è)

### –°—Ç–∏–ª–∏ –∏ –∞–Ω–∏–º–∞—Ü–∏–∏

**–ì—Ä–∞–¥–∏–µ–Ω—Ç—ã:**
- –§–æ–Ω: `linear-gradient(135deg, #667eea 0%, #764ba2 100%)`
- –ö–Ω–æ–ø–∫–∞: `linear-gradient(45deg, #FF6B6B, #FF8E53)`

**–ê–Ω–∏–º–∞—Ü–∏–∏:**
- `fadeIn` - –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ
- `fadeInDown` - –ü–æ—è–≤–ª–µ–Ω–∏–µ —Å–≤–µ—Ä—Ö—É
- `scaleIn` - –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å —Ü–µ–Ω—Ç—Ä–∞
- `bounce` - –ü–æ–∫–∞—á–∏–≤–∞–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è
- `spin` - –í—Ä–∞—â–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞
- `pulse` - –ü—É–ª—å—Å–∞—Ü–∏—è –ø—Ä–∏–∑–∞

### UX –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å:**
   - "–ó–∞–≥—Ä—É–∑–∫–∞..." –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ
   - "–†–∞—Å–ø–æ–∑–Ω–∞—é —Ä–µ—á—å —á–µ—Ä–µ–∑ AI..." –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ
   - Disabled –∫–Ω–æ–ø–∫–∞ –≤–æ –≤—Ä–µ–º—è –≤—Ä–∞—â–µ–Ω–∏—è

2. **Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   - `tg.expand()` - –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
   - `tg.ready()` - –°–æ–æ–±—â–∏—Ç—å –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
   - `tg.HapticFeedback` - –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

3. **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω:**
   - Responsive –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ —ç–∫—Ä–∞–Ω–æ–≤
   - Touch-friendly –∫–Ω–æ–ø–∫–∏
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–æ—Ç–æ–º

### –ö–æ–º–∞–Ω–¥–∞ `/roulette`
–û—Ç–∫—Ä—ã–≤–∞–µ—Ç Mini App —Å —Ä—É–ª–µ—Ç–∫–æ–π –Ω–∞–ø—Ä—è–º—É—é

### –ö–Ω–æ–ø–∫–∏ –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø—Ä–æ—Å–∞ (–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å/—Å—Ç–∞—Ä—Ç–∞–ø–µ—Ä/—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç):

```python
keyboard = [
    [InlineKeyboardButton("üåê –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–µ–π—Å—ã", url="...")],
    [InlineKeyboardButton("üóì –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–≤–æ–Ω–æ–∫", url="...")],
    [InlineKeyboardButton("üé∞ –ö—Ä—É—Ç–∏—Ç—å —Ä—É–ª–µ—Ç–∫—É –ø—Ä–∏–∑–æ–≤", 
                         web_app=WebAppInfo(url=config.webapp_url))]
]
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è URL

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `WEBAPP_URL`:
- **Development:** `http://localhost:8080`
- **Production:** `https://your-domain.com`

## Docker Configuration

### –°–µ—Ä–≤–∏—Å `webapp` –≤ `docker-compose.yml`

```yaml
webapp:
  build:
    context: .
    dockerfile: Dockerfile.webapp
  container_name: neuro-connector-webapp
  restart: unless-stopped
  depends_on:
    postgres:
      condition: service_healthy
  environment:
    DATABASE_URL: ${DATABASE_URL}
  volumes:
    - ./mini_app:/app
    - ./app/database.py:/app/app/database.py
    - ./app/config.py:/app/app/config.py
  ports:
    - "8080:8080"
  command: python server.py
```

### `Dockerfile.webapp`

```dockerfile
FROM python:3.11-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
COPY mini_app/ /app/
COPY app/database.py /app/app/
COPY app/config.py /app/app/
EXPOSE 8080
CMD ["python", "server.py"]
```

## –ó–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker compose logs webapp -f

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
docker compose down
```

### Production

1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º–µ–Ω –∏ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
2. –û–±–Ω–æ–≤–∏—Ç—å `WEBAPP_URL` –≤ `.env`
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ @BotFather:
   ```
   /setmenubutton
   <–≤—ã–±—Ä–∞—Ç—å –±–æ—Ç–∞>
   <—É–∫–∞–∑–∞—Ç—å URL Mini App>
   ```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### API —Ç–µ—Å—Ç—ã

```bash
# Health check
curl http://localhost:8080/api/health

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
curl "http://localhost:8080/api/can-spin?telegram_id=123456789"

# –ö—Ä—É—Ç–∏—Ç—å —Ä—É–ª–µ—Ç–∫—É
curl -X POST http://localhost:8080/api/spin \
  -H "Content-Type: application/json" \
  -d '{"telegram_id": 123456789}'

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ (–¥–æ–ª–∂–Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è)
curl "http://localhost:8080/api/can-spin?telegram_id=123456789"
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤

‚úÖ **Health endpoint:** `{"status": "ok"}`
‚úÖ **Can-spin (–Ω–æ–≤—ã–π):** `{"can_spin": true, "prize": null}`
‚úÖ **Spin:** `{"prize": 15000}`
‚úÖ **Can-spin (–ø–æ—Å–ª–µ —Å–ø–∏–Ω–∞):** `{"can_spin": false, "prize": 15000}`
‚úÖ **–ü–æ–≤—Ç–æ—Ä–Ω—ã–π spin:** `{"error": "Already spun", "prize": 15000}`

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **Telegram WebApp Validation**
   - `tg.initDataUnsafe` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è user ID
   - –í production –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∏ `initData`

2. **CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**
   - –†–∞–∑—Ä–µ—à–µ–Ω –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —Å Telegram –¥–æ–º–µ–Ω–æ–≤
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `aiohttp-cors`

3. **Rate limiting**
   - –û–¥–∏–Ω —Å–ø–∏–Ω –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (UNIQUE constraint)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞

4. **Database constraints**
   - UNIQUE telegram_id –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
   - NOT NULL –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏–Ω–æ–≤ –≤ –¥–µ–Ω—å
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–æ–≤
- –°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –ø—Ä–∏–∑–∞
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è (–æ–ø—Ä–æ—Å ‚Üí —Å–ø–∏–Ω)
- –û—à–∏–±–∫–∏ API

### SQL –∑–∞–ø—Ä–æ—Å—ã

```sql
-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–∏–∑–∞–º
SELECT 
    prize_amount,
    COUNT(*) as count,
    ROUND(AVG(prize_amount), 2) as avg
FROM roulette_spins
GROUP BY prize_amount
ORDER BY prize_amount;

-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–ø–∏–Ω—ã
SELECT 
    telegram_id,
    prize_amount,
    spun_at
FROM roulette_spins
ORDER BY spun_at DESC
LIMIT 10;

-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
SELECT 
    COUNT(*) as total_spins,
    AVG(prize_amount) as avg_prize,
    MIN(prize_amount) as min_prize,
    MAX(prize_amount) as max_prize
FROM roulette_spins;
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä webapp –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
```bash
docker compose logs webapp --tail=50
```

### –ü—Ä–æ–±–ª–µ–º–∞: API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
```bash
docker compose exec webapp python -c "from app.database import Database; import asyncio; asyncio.run(Database('...').connect())"
```

### –ü—Ä–æ–±–ª–µ–º–∞: Mini App –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `WEBAPP_URL` –≤ `.env`
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ webapp –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç 8080 –¥–æ—Å—Ç—É–ø–µ–Ω

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**
   - Dashboard —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
   - –û—Ç—á–µ—Ç—ã –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º
   - A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–æ–≤

2. **–ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è**
   - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Å–ø–∏–Ω—ã
   - –ë–æ–Ω—É—Å—ã –∑–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
   - –õ–∏–¥–µ—Ä–±–æ—Ä–¥

3. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è**
   - –ü—Ä–∏–∑—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
   - –ò—Å—Ç–æ—Ä–∏—è —Å–ø–∏–Ω–æ–≤
   - Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
   - CRM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
   - Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 28 —è–Ω–≤–∞—Ä—è 2026
